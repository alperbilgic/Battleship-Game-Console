RCGCSSI		EQU	 0x400FE61C
SSI0_CR0	EQU  0x40008000
SSI0_CR1	EQU	 0x40008004
SSI0_CPSR	EQU  0x40008010
SELO		EQU	 0x00C7
RCGC1		EQU  0x400FE104
RCGC2		EQU  0x400FE108


;LABEL		DIRECTIVE	VALUE		COMMENT
			AREA    	subroutin, READONLY, CODE
			THUMB

			EXPORT  	initSSI	; Make available
				
initSSI		PROC
	
			PUSH 		{R1,R0,R4,R2}
			
			LDR			R0,=RCGCSSI
			LDR			R1,[R0]
			ORR			R1,#0x01			; 
			STR			R1,[R0]				; 
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			NOP
			; PRSSI SHOULD HAVE BEEN CHECKED BUT THIS AMOUNT OF NOP OPERATIONS ARE PRETTY SUFFICIENT TO
			; ENSURE THAT THE SSI PERIPHERAL IS READY
						
			LDR 		R1,=SSI0_CR1		; 
			LDR 		R0,[ R1 ]
			BIC 		R0,#0x06				; SSI OPERATION IS DISABLED
			STR 		R0,[ R1 ] 				; CONFIGURATION OF PORT B ENDS
			
			
			
			LDR			R0,=SSI0_CPSR
			LDR			R1,[R0]
			AND			R1,R1,#0x00			; FREQUENCY WILL BE DECIDED
			ORR			R1,R1,#0x10			; PRESCALE IS GIVEN AS 24
			STR			R1,[R0]
			
			LDR 		R1,=SSI0_CR0		; 
			LDR 		R0,[ R1 ]
			AND 		R0,#0x0
			LDR			R2,=SELO
			ORR 		R0,R2			; 		
			STR 		R0,[ R1 ]
			
			LDR 		R1,=SSI0_CR1		;
			LDR			R0, [R1]
			ORR			R0, #0x02				; SSI OPERATION ENABLED AGAIN
			STR			R0, [R1]
			
			
			POP			{R1,R0,R4,R2}
			
			BX 			LR
			ENDP